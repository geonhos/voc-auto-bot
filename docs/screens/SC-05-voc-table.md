# SC-05: VOC 리스트 (테이블) 화면 정의

## 1. 화면 개요

### 1.1 목적
VOC 처리 담당자가 VOC 목록을 리스트 형태로 조회하고 관리할 수 있는 화면입니다.

### 1.2 연관 요구사항
- **FR-602**: 리스트 형태로 VOC 목록을 조회할 수 있다
- **FR-603**: 칸반보드와 리스트 뷰를 전환할 수 있다
- **FR-604**: VOC 클릭 시 상세 화면으로 이동한다

### 1.3 접근 권한
- **사용자 유형**: VOC 처리 담당자
- **권한 체크**: 로그인된 사용자의 역할이 'VOC 처리 담당자' 또는 '관리자'인 경우 접근 가능

---

## 2. 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────┐
│ Header (GNB)                                                │
│ - 로고, 사용자명, 로그아웃                                    │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ Breadcrumb                                                   │
│ 홈 > VOC 관리 > VOC 리스트                                   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ Page Header                                                  │
│ ┌───────────────────────────────┬───────────────────────┐   │
│ │ VOC 리스트                    │ [칸반] [테이블(Active)]│   │
│ └───────────────────────────────┴───────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ Filter/Search Section                                        │
│ ┌───────────────────────────────────────────────────────┐   │
│ │ 상태: [전체▼] 카테고리: [전체▼] 기간: [최근 7일▼]    │   │
│ │ 검색: [___________________] [검색]                     │   │
│ └───────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ VOC Table                                                    │
│ ┌────────┬──────────┬──────┬──────────┬────────┬──────┐    │
│ │ Ticket │ 제목     │ 상태 │ 카테고리 │ 접수일시│ 사용자│    │
│ │ ID     │          │      │          │        │      │    │
│ ├────────┼──────────┼──────┼──────────┼────────┼──────┤    │
│ │VOC-... │로그인 안됨│처리중│오류/버그 │2026-..│user@..│    │
│ │VOC-... │결제 오류 │분석중│오류/버그 │2026-..│test@..│    │
│ │VOC-... │UI 개선   │접수  │개선요청  │2026-..│admin@.│    │
│ └────────┴──────────┴──────┴──────────┴────────┴──────┘    │
└─────────────────────────────────────────────────────────────┘
┌─────────────────────────────────────────────────────────────┐
│ Pagination                                                   │
│           [<] [1] [2] [3] [4] [5] [>]                       │
│           총 234건 (1/12 페이지) | 페이지당: [20▼]          │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. UI 요소 목록

### 3.1 Page Header

#### 3.1.1 화면 제목
- **컴포넌트**: Heading (h1)
- **텍스트**: "VOC 리스트"
- **스타일**: 
  - Font Size: 24px
  - Font Weight: Bold
  - Color: #111827 (Gray 900)

#### 3.1.2 뷰 전환 버튼 그룹
- **컴포넌트**: Button Group (Toggle)
- **버튼 목록**:
  - **칸반 보기**: 클릭 시 SC-04 칸반 화면으로 전환
  - **테이블 보기**: 현재 활성 상태 (Primary Style)
- **스타일**:
  - Active: Primary Color (#3B82F6), Font Weight: Medium
  - Inactive: Gray Color (#6B7280)
- **접근성**: 
  - `role="tablist"`
  - `aria-label="뷰 전환"`

---

### 3.2 Filter/Search Section

#### 3.2.1 상태 필터
- **컴포넌트**: Select Dropdown
- **라벨**: "상태"
- **옵션**:
  - 전체 (기본값)
  - 접수
  - 분석중
  - 분석실패
  - 처리중
  - 완료
  - 반려
- **동작**: 선택 시 즉시 테이블 필터링
- **접근성**: `aria-label="상태 필터"`

#### 3.2.2 카테고리 필터
- **컴포넌트**: Select Dropdown
- **라벨**: "카테고리"
- **옵션**:
  - 전체 (기본값)
  - 오류/버그
  - 문의
  - 개선요청
  - 불만
  - (DB에서 동적 로드)
- **동작**: 선택 시 즉시 테이블 필터링
- **접근성**: `aria-label="카테고리 필터"`

#### 3.2.3 기간 필터
- **컴포넌트**: Select Dropdown
- **라벨**: "기간"
- **옵션**:
  - 오늘
  - 최근 7일 (기본값)
  - 최근 30일
  - 최근 90일
  - 사용자 지정 (Date Range Picker 표시)
- **동작**: 선택 시 즉시 테이블 필터링
- **접근성**: `aria-label="기간 필터"`

#### 3.2.4 검색 입력
- **컴포넌트**: Search Input
- **라벨**: "검색"
- **Placeholder**: "Ticket ID, 제목, 최종 사용자 이메일로 검색"
- **Max Length**: 100자
- **동작**: Enter 키 또는 검색 버튼 클릭 시 검색 실행
- **접근성**: 
  - `aria-label="VOC 검색"`
  - `type="search"`

#### 3.2.5 검색 버튼
- **컴포넌트**: Button (Primary)
- **텍스트**: "검색"
- **Icon**: Search Icon
- **동작**: 검색 실행
- **접근성**: `aria-label="검색 실행"`

---

### 3.3 VOC Table

#### 3.3.1 테이블 구조
- **컴포넌트**: Data Table
- **스타일**:
  - Border: 1px solid #E5E7EB (Gray 200)
  - Header Background: #F9FAFB (Gray 50)
  - Hover: #F3F4F6 (Gray 100)
- **접근성**:
  - `role="table"`
  - `aria-label="VOC 목록 테이블"`
  - Responsive (모바일에서 카드 형태로 변환)

#### 3.3.2 테이블 컬럼

##### (1) Ticket ID
- **헤더**: "Ticket ID"
- **정렬**: 가능 (기본: 내림차순)
- **너비**: 150px (고정)
- **포맷**: `VOC-YYYYMMDD-XXXXX`
- **스타일**:
  - Font Family: Monospace
  - Color: #3B82F6 (Blue 500)
  - Clickable (Link Style)
- **동작**: 클릭 시 상세 화면으로 이동
- **접근성**: `aria-label="티켓 ID {value}, 클릭하여 상세보기"`

##### (2) 제목
- **헤더**: "제목"
- **정렬**: 가능
- **너비**: Flexible (최소 200px)
- **Max Length**: 50자 (초과 시 말줄임)
- **스타일**:
  - Font Weight: Medium
  - Color: #111827 (Gray 900)
  - Text Overflow: Ellipsis
- **동작**: 클릭 시 상세 화면으로 이동
- **Tooltip**: 전체 제목 표시 (말줄임 시)

##### (3) 상태
- **헤더**: "상태"
- **정렬**: 가능
- **너비**: 100px (고정)
- **포맷**: Badge Component
- **상태별 스타일**:
  - **접수**: Gray Badge (#6B7280 배경)
  - **분석중**: Blue Badge (#3B82F6 배경) + 로딩 아이콘
  - **분석실패**: Red Badge (#EF4444 배경) + 경고 아이콘
  - **처리중**: Yellow Badge (#F59E0B 배경)
  - **완료**: Green Badge (#10B981 배경) + 체크 아이콘
  - **반려**: Red Badge (#EF4444 배경) + X 아이콘
- **접근성**: `aria-label="상태: {상태값}"`

##### (4) 카테고리
- **헤더**: "카테고리"
- **정렬**: 가능
- **너비**: 120px (고정)
- **포맷**: 대분류 표시 (중분류는 Tooltip)
- **스타일**:
  - Font Size: 14px
  - Color: #4B5563 (Gray 600)
- **Tooltip**: 중분류 표시 (계층 구조인 경우)

##### (5) 접수일시
- **헤더**: "접수일시"
- **정렬**: 가능 (기본 정렬 기준)
- **너비**: 150px (고정)
- **포맷**: 
  - 당일: `HH:mm`
  - 7일 이내: `MM/DD HH:mm`
  - 그 외: `YYYY-MM-DD`
- **스타일**:
  - Font Size: 14px
  - Color: #6B7280 (Gray 500)
- **접근성**: `aria-label="접수일시 {포맷된 날짜}"`

##### (6) 최종 사용자
- **헤더**: "최종 사용자"
- **정렬**: 가능
- **너비**: 180px (고정)
- **포맷**: 이메일 주소
- **스타일**:
  - Font Size: 14px
  - Color: #4B5563 (Gray 600)
- **개인정보 보호**: 
  - 이메일 마스킹 옵션 제공 (설정에 따라)
  - 예: `us***@example.com`

#### 3.3.3 정렬 기능
- **동작**: 
  - 컬럼 헤더 클릭 시 정렬 토글 (오름차순 ↔ 내림차순)
  - 정렬 아이콘 표시 (↑/↓)
- **기본 정렬**: 접수일시 내림차순 (최신순)
- **접근성**: 
  - `aria-sort="ascending|descending|none"`
  - `role="columnheader"`

#### 3.3.4 빈 상태
- **조건**: 조회 결과가 없는 경우
- **표시 내용**:
  - Icon: Empty State Icon
  - Message: "조회 결과가 없습니다"
  - Sub Message: "다른 필터를 선택하거나 검색어를 변경해 보세요"
- **스타일**: Center Aligned, Gray Color

---

### 3.4 Pagination

#### 3.4.1 페이지 네비게이션
- **컴포넌트**: Pagination
- **요소**:
  - **이전 버튼**: `[<]` 첫 페이지에서 비활성화
  - **페이지 번호**: 최대 5개 표시, 현재 페이지는 Primary Color
  - **다음 버튼**: `[>]` 마지막 페이지에서 비활성화
- **동작**: 페이지 변경 시 테이블 데이터 갱신
- **접근성**: 
  - `role="navigation"`
  - `aria-label="페이지네이션"`

#### 3.4.2 페이지 정보
- **텍스트**: "총 {totalCount}건 ({currentPage}/{totalPages} 페이지)"
- **스타일**: Font Size 14px, Gray Color

#### 3.4.3 페이지당 항목 수
- **컴포넌트**: Select Dropdown
- **라벨**: "페이지당"
- **옵션**: 10, 20, 50, 100 (기본값: 20)
- **동작**: 선택 시 페이지 크기 변경 및 첫 페이지로 이동
- **접근성**: `aria-label="페이지당 항목 수"`

---

## 4. 사용자 액션 및 이벤트

### 4.1 뷰 전환
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| 칸반 보기 클릭 | 칸반 버튼 클릭 | SC-04 화면으로 이동<br/>현재 필터 상태 유지 | - |

### 4.2 필터링
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| 상태 필터 변경 | Dropdown 선택 | 선택한 상태의 VOC만 표시<br/>첫 페이지로 이동 | - |
| 카테고리 필터 변경 | Dropdown 선택 | 선택한 카테고리의 VOC만 표시<br/>첫 페이지로 이동 | - |
| 기간 필터 변경 | Dropdown 선택 | 선택한 기간 내 VOC만 표시<br/>첫 페이지로 이동 | - |
| 사용자 지정 기간 | Date Range Picker | 시작일과 종료일 범위 내 VOC 표시 | 시작일 ≤ 종료일<br/>최대 1년 범위 |

### 4.3 검색
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| 검색 실행 | Enter 키 또는 검색 버튼 | Ticket ID, 제목, 최종 사용자 이메일 대상 검색<br/>첫 페이지로 이동 | 최소 2자 이상 |
| 검색어 삭제 | X 버튼 클릭 | 검색어 초기화 및 전체 목록 표시 | - |

### 4.4 정렬
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| 컬럼 헤더 클릭 | 헤더 클릭 | 해당 컬럼 기준 정렬 토글<br/>정렬 아이콘 업데이트 | - |

### 4.5 행 클릭
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| VOC 상세 보기 | Ticket ID 또는 제목 클릭 | SC-06 상세 화면으로 이동<br/>`/voc/{ticketId}` | - |

### 4.6 페이지네이션
| 액션 | 트리거 | 동작 | 검증 |
|------|--------|------|------|
| 페이지 이동 | 페이지 번호 클릭 | 해당 페이지 데이터 로드 | - |
| 이전/다음 페이지 | 화살표 버튼 클릭 | 이전/다음 페이지로 이동 | 범위 내 페이지만 가능 |
| 페이지 크기 변경 | Dropdown 선택 | 페이지당 항목 수 변경<br/>첫 페이지로 이동 | - |

---

## 5. 유효성 검사

### 5.1 검색어 검증
| 항목 | 규칙 | 에러 메시지 |
|------|------|-------------|
| 최소 길이 | 2자 이상 | "검색어는 최소 2자 이상 입력해주세요" |
| 최대 길이 | 100자 이하 | (입력 제한으로 처리) |
| 특수문자 | XSS 방지 sanitization | (자동 처리) |

### 5.2 날짜 범위 검증
| 항목 | 규칙 | 에러 메시지 |
|------|------|-------------|
| 시작일 ≤ 종료일 | 시작일이 종료일보다 이후일 수 없음 | "시작일은 종료일보다 이전이어야 합니다" |
| 최대 범위 | 1년 이내 | "최대 1년 범위까지 조회 가능합니다" |
| 미래 날짜 | 오늘 날짜 이후 선택 불가 | "미래 날짜는 선택할 수 없습니다" |

---

## 6. 에러 처리

### 6.1 API 에러
| 에러 유형 | HTTP Code | 처리 방법 |
|-----------|-----------|-----------|
| 인증 실패 | 401 | 로그인 페이지로 리다이렉트 |
| 권한 없음 | 403 | "접근 권한이 없습니다" Toast 메시지 표시 |
| 서버 오류 | 500 | "일시적인 오류가 발생했습니다. 잠시 후 다시 시도해주세요" Toast 메시지 표시 |
| 타임아웃 | 504 | "요청 시간이 초과되었습니다. 다시 시도해주세요" Toast 메시지 표시 |

### 6.2 네트워크 에러
| 상황 | 처리 방법 |
|------|-----------|
| 네트워크 끊김 | "네트워크 연결을 확인해주세요" Toast 메시지 표시<br/>[재시도] 버튼 제공 |
| API 응답 없음 | 로딩 스피너 표시 (최대 30초)<br/>타임아웃 시 에러 메시지 표시 |

### 6.3 데이터 에러
| 상황 | 처리 방법 |
|------|-----------|
| 빈 응답 | 빈 상태 UI 표시 |
| 잘못된 데이터 형식 | 콘솔 로그 기록<br/>"데이터를 불러오는 중 오류가 발생했습니다" 메시지 표시 |

---

## 7. 연관 API

### 7.1 VOC 리스트 조회
```
GET /api/v1/voc

Query Parameters:
- status: string (optional) - 상태 필터 (접수, 분석중, 분석실패, 처리중, 완료, 반려)
- category: string (optional) - 카테고리 필터
- startDate: string (optional) - 조회 시작일 (ISO 8601)
- endDate: string (optional) - 조회 종료일 (ISO 8601)
- search: string (optional) - 검색어 (Ticket ID, 제목, 이메일)
- page: number (default: 1) - 페이지 번호
- size: number (default: 20) - 페이지당 항목 수
- sortBy: string (default: "createdAt") - 정렬 기준 (ticketId, title, status, category, createdAt, endUserEmail)
- sortOrder: string (default: "desc") - 정렬 순서 (asc, desc)

Response 200:
{
  "data": [
    {
      "ticketId": "VOC-20260123-00001",
      "title": "로그인이 안됩니다",
      "status": "처리중",
      "category": {
        "id": "CAT-001",
        "name": "오류/버그",
        "subCategory": "시스템 오류"
      },
      "endUserEmail": "user@example.com",
      "createdAt": "2026-01-23T14:30:00Z",
      "updatedAt": "2026-01-23T15:00:00Z"
    }
  ],
  "pagination": {
    "currentPage": 1,
    "pageSize": 20,
    "totalCount": 234,
    "totalPages": 12
  }
}

Response 401: 인증 실패
Response 403: 권한 없음
Response 500: 서버 오류
```

### 7.2 카테고리 목록 조회
```
GET /api/v1/categories

Response 200:
{
  "data": [
    {
      "id": "CAT-001",
      "name": "오류/버그",
      "subCategories": ["시스템 오류", "데이터 오류", "화면 오류"]
    },
    {
      "id": "CAT-002",
      "name": "문의",
      "subCategories": ["사용 방법", "기능 문의", "정책 문의"]
    }
  ]
}
```

---

## 8. 화면 전환

### 8.1 진입 화면
| From | 조건 | 방법 |
|------|------|------|
| SC-04 (칸반 보기) | 테이블 뷰 버튼 클릭 | 화면 전환 |
| SC-06 (상세 화면) | 목록 버튼 클릭 | 뒤로가기 또는 목록 버튼 |
| 직접 URL 접근 | `/voc/list` | 권한 확인 후 표시 |

### 8.2 이탈 화면
| To | 트리거 | 데이터 유지 |
|----|--------|-------------|
| SC-04 (칸반 보기) | 칸반 뷰 버튼 클릭 | 필터 상태 유지 |
| SC-06 (상세 화면) | Ticket ID 또는 제목 클릭 | 스크롤 위치 저장 (뒤로가기 시 복원) |

---

## 9. 성능 요구사항

| 항목 | 목표 | 측정 방법 |
|------|------|-----------|
| 초기 로딩 시간 | 2초 이내 | API 응답 + 렌더링 완료 |
| 페이지 전환 시간 | 1초 이내 | API 응답 + 렌더링 완료 |
| 최대 동시 사용자 | 100명 | 부하 테스트 |

---

## 10. 접근성 요구사항

| 항목 | 요구사항 |
|------|----------|
| 스크린 리더 지원 | 모든 인터랙티브 요소에 aria-label 제공 |
| 키보드 네비게이션 | Tab, Enter, Space로 모든 기능 접근 가능 |
| 색상 대비 | WCAG 2.1 AA 기준 준수 (4.5:1 이상) |
| 반응형 디자인 | 모바일, 태블릿, 데스크톱 지원 |

---

## 11. 보안 요구사항

| 항목 | 요구사항 |
|------|----------|
| 개인정보 보호 | 이메일 주소 마스킹 옵션 제공 |
| XSS 방지 | 모든 입력값 sanitization |
| CSRF 방지 | API 요청 시 토큰 검증 |
| Rate Limiting | 분당 60회 요청 제한 |

---

## 12. 연관 이슈
- **GitHub Issue**: #5 - SC-05 VOC 리스트 테이블 화면 구현

---

## 13. 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 1.0 | 2026-01-23 | Claude Code | 초안 작성 |
