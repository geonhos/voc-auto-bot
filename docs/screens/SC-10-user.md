# SC-10: 사용자 관리 화면

> 관리자가 시스템 사용자 계정을 관리하는 화면

**이슈**: #10
**관련 요구사항**: FR-002, FR-005, FR-006
**최종 수정일**: 2026-01-23

---

## 1. 화면 개요

### 1.1 목적
관리자가 VOC Auto Bot 시스템의 사용자 계정을 생성, 수정, 삭제하고, 임시 비밀번호를 발급하여 계정을 관리할 수 있는 화면

### 1.2 사용자
- 관리자

### 1.3 접근 경로
- 내비게이션: 관리 > 사용자 관리
- URL: `/admin/users`

### 1.4 접근 권한
- 역할: `ADMIN` (관리자만 접근 가능)
- 인증: 로그인 필수
- 권한 검증: 페이지 진입 시 역할 확인, 비인가 시 403 에러 또는 홈으로 리다이렉트

---

## 2. 레이아웃 구조

```
┌─────────────────────────────────────────────────────────────┐
│ Header (공통)                                                │
├─────────────────────────────────────────────────────────────┤
│ Navigation (공통)                                            │
├─────────────────────────────────────────────────────────────┤
│ [사용자 관리]                                                 │
│                                                              │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ 검색 영역                                            │     │
│ │ [이름/이메일 검색] [역할 필터] [상태 필터] [검색 버튼] │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                              │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ 액션 영역                                            │     │
│ │ [+ 사용자 추가]                          [새로고침]   │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                              │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ 사용자 목록 테이블                                    │     │
│ │ ┌────┬────────┬──────────┬──────┬────────┬────┐    │     │
│ │ │ID  │이름    │이메일     │역할  │상태     │액션│    │     │
│ │ ├────┼────────┼──────────┼──────┼────────┼────┤    │     │
│ │ │001 │홍길동  │hong@... │VOC접수│활성    │... │    │     │
│ │ │002 │김철수  │kim@...  │담당자 │활성    │... │    │     │
│ │ │003 │이영희  │lee@...  │관리자 │잠금    │... │    │     │
│ │ └────┴────────┴──────────┴──────┴────────┴────┘    │     │
│ └─────────────────────────────────────────────────────┘     │
│                                                              │
│ ┌─────────────────────────────────────────────────────┐     │
│ │ 페이지네이션                                          │     │
│ │           [1] [2] [3] ... [10]                      │     │
│ └─────────────────────────────────────────────────────┘     │
└─────────────────────────────────────────────────────────────┘
```

---

## 3. UI 요소 목록

### 3.1 검색 영역

| 요소 | 타입 | 설명 | 필수 여부 |
|------|------|------|----------|
| 검색어 입력 | Input Text | 이름 또는 이메일로 검색 (부분 일치) | 선택 |
| 역할 필터 | Dropdown | 전체 / VOC 접수자 / VOC 처리 담당자 / 관리자 | 선택 |
| 상태 필터 | Dropdown | 전체 / 활성 / 비활성 / 잠금 / 임시 비밀번호 | 선택 |
| 검색 버튼 | Button | 검색 실행 | - |

**역할 옵션**:
- 전체 (기본값)
- VOC 접수자 (REPORTER)
- VOC 처리 담당자 (HANDLER)
- 관리자 (ADMIN)

**상태 옵션**:
- 전체 (기본값)
- 활성 (ACTIVE)
- 비활성 (INACTIVE)
- 잠금 (LOCKED) - 로그인 실패 5회 이상
- 임시 비밀번호 (TEMP_PASSWORD)

### 3.2 액션 영역

| 요소 | 타입 | 설명 |
|------|------|------|
| 사용자 추가 버튼 | Button (Primary) | 사용자 추가 모달 열기 |
| 새로고침 버튼 | Button (Secondary) | 목록 새로고침 |

### 3.3 사용자 목록 테이블

| 컬럼 | 너비 | 정렬 | 설명 |
|------|------|------|------|
| ID | 80px | 가능 | 사용자 고유 ID |
| 이름 | 120px | 가능 | 사용자 이름 |
| 이메일 | 200px | 가능 | 로그인 아이디 (이메일) |
| 역할 | 120px | 가능 | 사용자 역할 (배지 형태) |
| 상태 | 100px | 가능 | 계정 상태 (배지 형태) |
| 생성일 | 140px | 가능 | 계정 생성일 (YYYY-MM-DD HH:mm) |
| 마지막 로그인 | 140px | 가능 | 마지막 로그인 일시 (YYYY-MM-DD HH:mm) |
| 액션 | 150px | - | 수정/삭제/비밀번호 재발급 버튼 |

**역할 배지 색상**:
- VOC 접수자: 파란색
- VOC 처리 담당자: 녹색
- 관리자: 빨간색

**상태 배지 색상**:
- 활성: 녹색
- 비활성: 회색
- 잠금: 주황색
- 임시 비밀번호: 노란색

**액션 버튼**:
- 수정 (연필 아이콘)
- 삭제 (휴지통 아이콘) - 확인 다이얼로그 표시
- 임시 비밀번호 발급 (열쇠 아이콘) - 확인 다이얼로그 표시

### 3.4 페이지네이션

- 한 페이지당 20건 표시
- 페이지 번호 클릭으로 이동
- 이전/다음 버튼 제공

---

## 4. 모달 상세

### 4.1 사용자 추가 모달

**모달 제목**: "사용자 추가"

| 필드 | 타입 | 필수 | 설명 | 유효성 검사 |
|------|------|------|------|------------|
| 이름 | Input Text | 필수 | 사용자 이름 | 2-50자, 한글/영문/숫자 |
| 이메일 | Input Email | 필수 | 로그인 아이디 (이메일) | 이메일 형식, 중복 검사 |
| 역할 | Radio Button | 필수 | 사용자 역할 | VOC 접수자, VOC 처리 담당자, 관리자 중 선택 |
| 초기 비밀번호 | - | - | 자동 생성 (임시 비밀번호) | - |

**버튼**:
- 취소: 모달 닫기
- 저장: 사용자 생성 및 임시 비밀번호 발급

**생성 후 동작**:
1. 사용자 생성 성공 시 성공 메시지 표시
2. 생성된 임시 비밀번호를 다이얼로그로 표시 (복사 버튼 제공)
3. 사용자에게 전달할 수 있도록 임시 비밀번호를 화면에 1회만 표시 (재조회 불가)
4. 목록 새로고침

### 4.2 사용자 수정 모달

**모달 제목**: "사용자 수정"

| 필드 | 타입 | 필수 | 설명 | 유효성 검사 |
|------|------|------|------|------------|
| 이름 | Input Text | 필수 | 사용자 이름 | 2-50자, 한글/영문/숫자 |
| 이메일 | Input Email (읽기 전용) | - | 로그인 아이디 (변경 불가) | - |
| 역할 | Radio Button | 필수 | 사용자 역할 | VOC 접수자, VOC 처리 담당자, 관리자 중 선택 |
| 상태 | Radio Button | 필수 | 계정 상태 | 활성, 비활성 중 선택 |

**버튼**:
- 취소: 모달 닫기 (변경사항 미저장)
- 저장: 사용자 정보 수정

**수정 후 동작**:
1. 수정 성공 시 성공 메시지 표시
2. 목록 새로고침

### 4.3 사용자 삭제 확인 다이얼로그

**제목**: "사용자 삭제"

**메시지**:
```
"{사용자 이름}" 계정을 삭제하시겠습니까?

삭제된 계정은 복구할 수 없으며, 해당 사용자의 모든 활동 이력은 유지됩니다.
```

**버튼**:
- 취소: 다이얼로그 닫기
- 삭제: 사용자 삭제 실행

**삭제 조건**:
- 자기 자신은 삭제 불가 (에러 메시지 표시)
- 삭제 시 사용자 데이터는 논리 삭제(Soft Delete) 처리
- VOC 이력은 유지 (작성자/처리자 정보는 "삭제된 사용자"로 표시)

### 4.4 임시 비밀번호 발급 확인 다이얼로그

**제목**: "임시 비밀번호 발급"

**메시지**:
```
"{사용자 이름}"에게 임시 비밀번호를 발급하시겠습니까?

기존 비밀번호는 무효화되며, 사용자는 임시 비밀번호로 로그인 후 비밀번호를 변경해야 합니다.
```

**버튼**:
- 취소: 다이얼로그 닫기
- 발급: 임시 비밀번호 생성 및 발급

**발급 후 동작**:
1. 임시 비밀번호 생성 (8자 이상, 영문/숫자/특수문자 조합)
2. 생성된 임시 비밀번호를 다이얼로그로 표시 (복사 버튼 제공)
3. 사용자에게 전달할 수 있도록 임시 비밀번호를 화면에 1회만 표시 (재조회 불가)
4. 사용자 상태를 "임시 비밀번호"로 변경
5. 목록 새로고침

**임시 비밀번호 표시 다이얼로그**:
```
임시 비밀번호가 발급되었습니다.

임시 비밀번호: [************] [복사 버튼]

이 비밀번호는 이 화면을 닫으면 다시 조회할 수 없습니다.
사용자에게 안전하게 전달해 주세요.
```

**버튼**:
- 복사: 클립보드에 비밀번호 복사
- 확인: 다이얼로그 닫기

---

## 5. 사용자 액션 및 이벤트

### 5.1 검색 및 필터링

| 액션 | 트리거 | 동작 |
|------|--------|------|
| 검색어 입력 | 검색 버튼 클릭 또는 Enter | 입력한 검색어로 이름/이메일 부분 일치 검색 |
| 역할 필터 선택 | Dropdown 변경 | 선택한 역할로 필터링 |
| 상태 필터 선택 | Dropdown 변경 | 선택한 상태로 필터링 |
| 검색 초기화 | 검색어 삭제 | 전체 목록 표시 |

**검색 조건 조합**:
- 검색어 + 역할 + 상태 모두 AND 조건으로 적용
- 검색어 없이 필터만 적용 가능

### 5.2 사용자 관리

| 액션 | 트리거 | 동작 |
|------|--------|------|
| 사용자 추가 | "사용자 추가" 버튼 클릭 | 사용자 추가 모달 열기 |
| 사용자 수정 | 테이블 행의 "수정" 버튼 클릭 | 사용자 수정 모달 열기 (기존 정보 로드) |
| 사용자 삭제 | 테이블 행의 "삭제" 버튼 클릭 | 삭제 확인 다이얼로그 표시 → 확인 시 삭제 실행 |
| 임시 비밀번호 발급 | 테이블 행의 "임시 비밀번호 발급" 버튼 클릭 | 발급 확인 다이얼로그 표시 → 확인 시 임시 비밀번호 생성 및 표시 |
| 목록 새로고침 | "새로고침" 버튼 클릭 | 현재 필터 조건으로 목록 재조회 |

### 5.3 테이블 인터랙션

| 액션 | 트리거 | 동작 |
|------|--------|------|
| 정렬 | 컬럼 헤더 클릭 | 해당 컬럼 기준 오름차순/내림차순 정렬 토글 |
| 페이지 이동 | 페이지 번호 클릭 | 해당 페이지로 이동 |
| 행 클릭 | 테이블 행 클릭 (액션 버튼 제외) | 사용자 수정 모달 열기 (옵션) |

---

## 6. 유효성 검사

### 6.1 사용자 추가/수정 시 유효성 검사

| 필드 | 검사 규칙 | 에러 메시지 |
|------|----------|------------|
| 이름 | 필수 입력 | "이름을 입력해 주세요." |
| 이름 | 2-50자 | "이름은 2자 이상 50자 이하로 입력해 주세요." |
| 이름 | 한글/영문/숫자만 허용 | "이름은 한글, 영문, 숫자만 입력 가능합니다." |
| 이메일 | 필수 입력 | "이메일을 입력해 주세요." |
| 이메일 | 이메일 형식 | "올바른 이메일 형식이 아닙니다." |
| 이메일 | 중복 검사 (추가 시) | "이미 사용 중인 이메일입니다." |
| 역할 | 필수 선택 | "역할을 선택해 주세요." |
| 상태 | 필수 선택 | "상태를 선택해 주세요." |

### 6.2 비즈니스 규칙 검증

| 규칙 | 검증 시점 | 에러 메시지 |
|------|----------|------------|
| 자기 자신 삭제 금지 | 삭제 버튼 클릭 시 | "자기 자신의 계정은 삭제할 수 없습니다." |
| 마지막 관리자 삭제 금지 | 삭제 버튼 클릭 시 | "시스템에 최소 1명의 관리자가 필요합니다." |
| 마지막 관리자 역할 변경 금지 | 수정 저장 시 | "시스템에 최소 1명의 관리자가 필요합니다." |

---

## 7. 에러 처리

### 7.1 API 에러 처리

| 에러 상황 | HTTP 상태 | 에러 메시지 | 사용자 액션 |
|----------|-----------|------------|------------|
| 권한 없음 | 403 | "사용자 관리 권한이 없습니다." | 홈으로 리다이렉트 |
| 사용자 미존재 | 404 | "존재하지 않는 사용자입니다." | 목록 새로고침 |
| 이메일 중복 | 409 | "이미 사용 중인 이메일입니다." | 이메일 수정 요청 |
| 서버 오류 | 500 | "서버 오류가 발생했습니다. 잠시 후 다시 시도해 주세요." | 재시도 권장 |
| 네트워크 오류 | - | "네트워크 연결을 확인해 주세요." | 재시도 권장 |

### 7.2 클라이언트 에러 처리

| 에러 상황 | 처리 방법 |
|----------|----------|
| 빈 검색 결과 | "검색 결과가 없습니다." 메시지 표시 |
| 로딩 실패 | 에러 메시지 표시 + 재시도 버튼 제공 |
| 모달 로딩 실패 | 에러 토스트 메시지 + 모달 닫기 |

### 7.3 에러 표시 방식

- **필드 레벨 에러**: 입력 필드 하단에 빨간색 텍스트로 표시
- **폼 레벨 에러**: 모달 상단에 경고 배너로 표시
- **시스템 에러**: 화면 상단에 토스트 메시지로 표시 (3초 후 자동 사라짐)
- **확인 필요 에러**: 다이얼로그로 표시 (사용자 확인 필요)

---

## 8. 연관 API

### 8.1 사용자 목록 조회

```
GET /api/admin/users
```

**Query Parameters**:
- `search`: 검색어 (이름/이메일 부분 일치)
- `role`: 역할 필터 (REPORTER, HANDLER, ADMIN)
- `status`: 상태 필터 (ACTIVE, INACTIVE, LOCKED, TEMP_PASSWORD)
- `page`: 페이지 번호 (기본값: 1)
- `size`: 페이지 크기 (기본값: 20)
- `sort`: 정렬 기준 (예: `name,asc` 또는 `createdAt,desc`)

**Response**:
```json
{
  "content": [
    {
      "id": 1,
      "name": "홍길동",
      "email": "hong@example.com",
      "role": "REPORTER",
      "status": "ACTIVE",
      "createdAt": "2026-01-15T09:00:00Z",
      "lastLoginAt": "2026-01-23T14:30:00Z"
    }
  ],
  "totalElements": 100,
  "totalPages": 5,
  "currentPage": 1,
  "size": 20
}
```

### 8.2 사용자 생성

```
POST /api/admin/users
```

**Request Body**:
```json
{
  "name": "홍길동",
  "email": "hong@example.com",
  "role": "REPORTER"
}
```

**Response**:
```json
{
  "id": 1,
  "name": "홍길동",
  "email": "hong@example.com",
  "role": "REPORTER",
  "status": "TEMP_PASSWORD",
  "temporaryPassword": "Temp1234!@#$",
  "createdAt": "2026-01-23T15:00:00Z"
}
```

**참고**: 임시 비밀번호는 응답에 1회만 포함되며, 이후 재조회 불가

### 8.3 사용자 수정

```
PUT /api/admin/users/{userId}
```

**Request Body**:
```json
{
  "name": "홍길동",
  "role": "HANDLER",
  "status": "ACTIVE"
}
```

**Response**:
```json
{
  "id": 1,
  "name": "홍길동",
  "email": "hong@example.com",
  "role": "HANDLER",
  "status": "ACTIVE",
  "updatedAt": "2026-01-23T15:10:00Z"
}
```

### 8.4 사용자 삭제

```
DELETE /api/admin/users/{userId}
```

**Response**:
```json
{
  "message": "사용자가 삭제되었습니다.",
  "deletedAt": "2026-01-23T15:20:00Z"
}
```

**참고**: Soft Delete 처리 (실제 데이터는 삭제되지 않음)

### 8.5 임시 비밀번호 발급

```
POST /api/admin/users/{userId}/temporary-password
```

**Response**:
```json
{
  "userId": 1,
  "temporaryPassword": "NewTemp5678!@#$",
  "issuedAt": "2026-01-23T15:30:00Z"
}
```

**참고**:
- 임시 비밀번호는 응답에 1회만 포함되며, 이후 재조회 불가
- 기존 비밀번호는 즉시 무효화됨
- 사용자 상태가 `TEMP_PASSWORD`로 변경됨

### 8.6 이메일 중복 검사

```
GET /api/admin/users/check-email?email={email}
```

**Response**:
```json
{
  "available": true
}
```

---

## 9. 화면 전환

### 9.1 진입 경로

| 출발 화면 | 조건 | 도착 화면 |
|----------|------|----------|
| 내비게이션 메뉴 | "사용자 관리" 클릭 | SC-10 사용자 관리 |
| 로그인 후 | 관리자 역할 + 직접 URL 접근 | SC-10 사용자 관리 |

### 9.2 이탈 경로

| 출발 화면 | 액션 | 도착 화면 |
|----------|------|----------|
| SC-10 사용자 관리 | 내비게이션 메뉴 클릭 | 해당 메뉴 화면 |
| SC-10 사용자 관리 | 로그아웃 | SC-01 로그인 |
| SC-10 사용자 관리 | 권한 없음 | 홈 또는 403 에러 페이지 |

### 9.3 페이지 상태 유지

- 검색/필터 조건: URL Query Parameter로 관리 (브라우저 뒤로가기 지원)
- 페이지 번호: URL Query Parameter로 관리
- 정렬 조건: URL Query Parameter로 관리

**예시 URL**:
```
/admin/users?search=홍길동&role=REPORTER&status=ACTIVE&page=2&sort=createdAt,desc
```

---

## 10. 주요 사용 시나리오

### 10.1 신규 사용자 추가

1. 관리자가 "사용자 추가" 버튼 클릭
2. 사용자 추가 모달에서 이름, 이메일, 역할 입력
3. "저장" 버튼 클릭
4. 사용자 생성 완료 후 임시 비밀번호 다이얼로그 표시
5. 임시 비밀번호 복사 후 새 사용자에게 전달
6. 사용자 목록에 새 사용자 추가됨

### 10.2 사용자 역할 변경

1. 관리자가 사용자 목록에서 수정할 사용자의 "수정" 버튼 클릭
2. 사용자 수정 모달에서 역할 변경
3. "저장" 버튼 클릭
4. 성공 메시지 표시 및 목록 새로고침

### 10.3 비밀번호 분실 시 임시 비밀번호 발급

1. 사용자가 비밀번호 분실을 관리자에게 요청
2. 관리자가 해당 사용자의 "임시 비밀번호 발급" 버튼 클릭
3. 발급 확인 다이얼로그에서 "발급" 버튼 클릭
4. 생성된 임시 비밀번호 다이얼로그 표시
5. 임시 비밀번호 복사 후 사용자에게 전달
6. 사용자가 임시 비밀번호로 로그인 후 비밀번호 변경 강제 (FR-006)

### 10.4 계정 잠금 해제

1. 관리자가 잠금 상태인 사용자 확인 (로그인 실패 5회)
2. 해당 사용자의 "수정" 버튼 클릭
3. 상태를 "활성"으로 변경 또는 임시 비밀번호 발급
4. "저장" 버튼 클릭
5. 계정 잠금 해제 완료

### 10.5 퇴사자 계정 비활성화

1. 관리자가 퇴사자 계정의 "수정" 버튼 클릭
2. 상태를 "비활성"으로 변경
3. "저장" 버튼 클릭
4. 계정 비활성화 완료 (로그인 불가)

---

## 11. 접근성 (Accessibility)

### 11.1 키보드 내비게이션

- Tab 키로 모든 인터랙티브 요소 접근 가능
- Enter 키로 버튼 활성화
- Esc 키로 모달/다이얼로그 닫기
- 화살표 키로 드롭다운 메뉴 탐색

### 11.2 스크린 리더 지원

- 모든 입력 필드에 `aria-label` 또는 `<label>` 연결
- 에러 메시지에 `role="alert"` 속성 추가
- 테이블에 적절한 `<caption>` 및 `<th scope>` 사용
- 버튼에 명확한 `aria-label` 제공 (아이콘 버튼의 경우)

### 11.3 시각적 표시

- 포커스 상태 명확히 표시 (outline)
- 색상만으로 정보 전달하지 않음 (아이콘, 텍스트 병행)
- 충분한 색상 대비 (WCAG AA 준수)

---

## 12. 성능 고려사항

### 12.1 최적화

- 사용자 목록 페이지네이션 (20건씩)
- 검색/필터 디바운싱 (300ms)
- 테이블 정렬 시 서버 사이드 정렬 사용
- 불필요한 API 재호출 방지 (캐싱 전략)

### 12.2 로딩 상태

- 목록 로딩 시 스켈레톤 UI 표시
- 버튼 클릭 시 로딩 인디케이터 표시 (중복 클릭 방지)
- 모달 로딩 시 스피너 표시

---

## 13. 보안 고려사항

### 13.1 권한 검증

- 페이지 진입 시 관리자 권한 확인 (프론트엔드 + 백엔드)
- 모든 API 요청에 인증 토큰 포함
- API 레벨에서 권한 재확인

### 13.2 임시 비밀번호 처리

- 임시 비밀번호는 서버에서 생성 (프론트엔드 생성 금지)
- 임시 비밀번호는 암호화하여 저장 (평문 저장 금지)
- 임시 비밀번호는 1회만 조회 가능 (재조회 불가)
- 임시 비밀번호 발급 시 기존 비밀번호 즉시 무효화

### 13.3 입력 검증

- 클라이언트 사이드 검증 + 서버 사이드 검증 (이중 검증)
- XSS 방지를 위한 입력값 sanitization
- SQL Injection 방지를 위한 Prepared Statement 사용

---

## 14. 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0 | 2026-01-23 | Claude Code | 초안 작성 |
