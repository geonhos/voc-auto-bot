<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Email Sending - VOC Auto Bot</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;family=Noto+Sans+KR:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#556780",
                        "primary-light": "#8a9db3",
                        "primary-dark": "#2d3745",
                        "background-light": "#f5f5f4",
                        "background-dark": "#1c1917",
                        "surface-light": "#ffffff",
                        "surface-dark": "#2d3745",
                        "border-light": "#e7e5e4",
                        "border-dark": "#373330",
                        "success": "#6b8e6b",
                        "warning": "#b38f4d",
                        "danger": "#a16060",
                        "info": "#5b8a8a",
                    },
                    fontFamily: {
                        display: ["Inter", "Noto Sans KR", "sans-serif"],
                        body: ["Inter", "Noto Sans KR", "sans-serif"],
                    },
                    borderRadius: {
                        DEFAULT: "0.375rem",
                    },
                },
            },
        };
    </script>
    <style>
        body {
            font-family: 'Inter', 'Noto Sans KR', sans-serif;
        }
        .required::after {
            content: '*';
            color: #a16060;
            margin-left: 4px;
        }
        .modal-overlay {
            background-color: rgba(0, 0, 0, 0.5);
        }
        .char-count {
            font-variant-numeric: tabular-nums;
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 min-h-screen flex items-center justify-center p-4">

<!-- Modal Overlay -->
<div class="modal-overlay fixed inset-0 z-40"></div>

<!-- Email Sending Modal -->
<div role="dialog" aria-labelledby="email-modal-title" aria-modal="true" class="relative z-50 bg-surface-light dark:bg-surface-dark rounded-xl shadow-2xl border border-border-light dark:border-border-dark w-full max-w-3xl max-h-[90vh] flex flex-col">

    <!-- Modal Header -->
    <div class="flex items-center justify-between px-6 py-4 border-b border-border-light dark:border-border-dark">
        <h2 id="email-modal-title" class="text-xl font-bold">이메일 발송</h2>
        <div class="flex items-center gap-2">
            <button type="button" class="px-4 py-2 text-sm font-medium text-primary hover:text-primary-dark transition-colors flex items-center gap-1">
                <span class="material-icons-outlined text-lg">visibility</span>
                미리보기
            </button>
            <a href="SC-06-voc-detail.html" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                <span class="material-icons-outlined text-slate-600 dark:text-slate-300">close</span>
            </a>
        </div>
    </div>

    <!-- Modal Body (Scrollable) -->
    <div class="flex-grow overflow-y-auto px-6 py-6">
        <form class="space-y-6">

            <!-- Recipient -->
            <div>
                <label class="block text-sm font-semibold mb-2 required" for="email-recipient">수신자</label>
                <input
                    class="w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-border-light dark:border-border-dark rounded focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all cursor-not-allowed"
                    id="email-recipient"
                    name="recipient"
                    type="email"
                    value="user@example.com"
                    readonly
                    aria-required="true"
                    aria-describedby="recipient-help"
                />
                <p id="recipient-help" class="text-xs text-slate-500 dark:text-slate-400 mt-1">VOC 접수 시 입력된 최종 사용자 이메일</p>
            </div>

            <!-- Template Selection -->
            <div>
                <div class="flex items-center justify-between mb-2">
                    <label class="block text-sm font-semibold" for="email-template">템플릿 선택</label>
                    <button type="button" class="text-xs font-medium text-primary hover:text-primary-dark transition-colors flex items-center gap-1">
                        <span class="material-icons-outlined text-sm">settings</span>
                        템플릿 관리
                    </button>
                </div>
                <select
                    class="w-full px-4 py-2 bg-white dark:bg-slate-800 border border-border-light dark:border-border-dark rounded focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"
                    id="email-template"
                    name="templateId"
                >
                    <option value="template-001" selected>VOC 완료 안내 (기본)</option>
                    <option value="template-002">VOC 반려 안내</option>
                    <option value="template-003">추가 정보 요청</option>
                    <option value="template-004">사용자 정의 템플릿 1</option>
                </select>
            </div>

            <!-- Subject -->
            <div>
                <label class="block text-sm font-semibold mb-2 required" for="email-subject">제목</label>
                <input
                    class="w-full px-4 py-2 bg-white dark:bg-slate-800 border border-border-light dark:border-border-dark rounded focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all"
                    id="email-subject"
                    name="subject"
                    type="text"
                    value="[VOC-20260123-00001] VOC 처리 완료 안내"
                    placeholder="이메일 제목을 입력하세요"
                    maxlength="200"
                    required
                    aria-required="true"
                    aria-invalid="false"
                    aria-describedby="subject-error"
                />
                <span id="subject-error" role="alert" class="text-xs text-danger mt-1 hidden">제목을 입력해 주세요.</span>
            </div>

            <!-- Body -->
            <div>
                <label class="block text-sm font-semibold mb-2 required" for="email-body">본문</label>
                <textarea
                    class="w-full px-4 py-2 bg-white dark:bg-slate-800 border border-border-light dark:border-border-dark rounded focus:ring-2 focus:ring-primary focus:border-transparent outline-none transition-all resize-none"
                    id="email-body"
                    name="body"
                    rows="12"
                    maxlength="2000"
                    placeholder="이메일 본문을 입력하세요"
                    required
                    aria-required="true"
                    aria-invalid="false"
                    aria-describedby="body-error body-char-count"
                >안녕하세요.

고객님께서 문의하신 [로그인 오류 문의] 건이 처리 완료되었습니다.

처리 내용:
시스템 오류 수정 완료되었으며, 정상적으로 로그인이 가능합니다. 추가로 보안 패치도 적용하였습니다.

추가 문의사항이 있으시면 언제든지 연락 주시기 바랍니다.

감사합니다.</textarea>
                <div class="flex items-center justify-between mt-1">
                    <span id="body-error" role="alert" class="text-xs text-danger hidden">본문을 입력해 주세요.</span>
                    <span id="body-char-count" aria-live="polite" class="text-xs text-slate-500 dark:text-slate-400 char-count">156 / 2000자</span>
                </div>
            </div>

            <!-- Template Variables Info -->
            <div class="p-4 bg-info/10 dark:bg-info/5 border border-info/20 rounded-lg">
                <div class="flex gap-2 mb-2">
                    <span class="material-icons-outlined text-info text-lg">info</span>
                    <p class="text-sm font-semibold text-slate-700 dark:text-slate-300">사용 가능한 변수</p>
                </div>
                <ul class="text-xs text-slate-600 dark:text-slate-400 space-y-1 ml-7">
                    <li><code class="bg-slate-100 dark:bg-slate-800 px-1 py-0.5 rounded">{{'{{'}}ticketId{{'}}'}}</code> - VOC 접수번호 (예: VOC-20260123-00001)</li>
                    <li><code class="bg-slate-100 dark:bg-slate-800 px-1 py-0.5 rounded">{{'{{'}}title{{'}}'}}</code> - VOC 제목 (예: 로그인 오류 문의)</li>
                    <li><code class="bg-slate-100 dark:bg-slate-800 px-1 py-0.5 rounded">{{'{{'}}status{{'}}'}}</code> - 처리 상태 (예: 완료 / 반려)</li>
                    <li><code class="bg-slate-100 dark:bg-slate-800 px-1 py-0.5 rounded">{{'{{'}}processingNote{{'}}'}}</code> - 처리 내용</li>
                    <li><code class="bg-slate-100 dark:bg-slate-800 px-1 py-0.5 rounded">{{'{{'}}rejectReason{{'}}'}}</code> - 반려 사유 (반려 시에만 사용)</li>
                </ul>
            </div>

        </form>
    </div>

    <!-- Modal Footer -->
    <div class="px-6 py-4 border-t border-border-light dark:border-border-dark flex flex-col sm:flex-row gap-3 justify-end">
        <button
            type="button"
            class="px-6 py-3 border border-border-light dark:border-border-dark text-slate-600 dark:text-slate-300 font-semibold rounded hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"
        >
            취소
        </button>
        <button
            type="button"
            class="px-6 py-3 border border-primary text-primary font-semibold rounded hover:bg-primary/10 transition-colors"
        >
            임시저장
        </button>
        <button
            type="submit"
            class="px-6 py-3 bg-primary text-white font-semibold rounded hover:bg-primary-dark transition-colors shadow-sm flex items-center gap-2"
        >
            <span class="material-icons-outlined text-lg">send</span>
            발송
        </button>
    </div>
</div>

<!-- Preview Modal (Hidden by default) -->
<div class="hidden fixed inset-0 z-60 flex items-center justify-center p-4">
    <div class="modal-overlay fixed inset-0"></div>
    <div role="dialog" aria-labelledby="preview-modal-title" aria-modal="true" class="relative z-70 bg-surface-light dark:bg-surface-dark rounded-xl shadow-2xl border border-border-light dark:border-border-dark w-full max-w-2xl max-h-[90vh] flex flex-col">

        <!-- Preview Header -->
        <div class="flex items-center justify-between px-6 py-4 border-b border-border-light dark:border-border-dark">
            <h2 id="preview-modal-title" class="text-xl font-bold">이메일 미리보기</h2>
            <button type="button" class="p-2 rounded-full hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                <span class="material-icons-outlined text-slate-600 dark:text-slate-300">close</span>
            </button>
        </div>

        <!-- Preview Body -->
        <div class="flex-grow overflow-y-auto px-6 py-6">
            <div class="space-y-4">
                <div>
                    <p class="text-sm font-semibold text-slate-500 dark:text-slate-400 mb-1">수신자</p>
                    <p class="text-sm">user@example.com</p>
                </div>
                <div>
                    <p class="text-sm font-semibold text-slate-500 dark:text-slate-400 mb-1">제목</p>
                    <p class="text-sm font-medium">[VOC-20260123-00001] VOC 처리 완료 안내</p>
                </div>
                <div>
                    <p class="text-sm font-semibold text-slate-500 dark:text-slate-400 mb-3">본문</p>
                    <div class="p-6 bg-slate-50 dark:bg-slate-800 border border-border-light dark:border-border-dark rounded-lg">
                        <div class="prose prose-sm dark:prose-invert max-w-none">
                            <p>안녕하세요.</p>
                            <p>고객님께서 문의하신 [로그인 오류 문의] 건이 처리 완료되었습니다.</p>
                            <p><strong>처리 내용:</strong><br/>시스템 오류 수정 완료되었으며, 정상적으로 로그인이 가능합니다. 추가로 보안 패치도 적용하였습니다.</p>
                            <p>추가 문의사항이 있으시면 언제든지 연락 주시기 바랍니다.</p>
                            <p>감사합니다.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Footer -->
        <div class="px-6 py-4 border-t border-border-light dark:border-border-dark flex justify-end">
            <button
                type="button"
                class="px-6 py-3 border border-border-light dark:border-border-dark text-slate-600 dark:text-slate-300 font-semibold rounded hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"
            >
                닫기
            </button>
        </div>
    </div>
</div>

<!-- Confirmation Dialog (Hidden by default) -->
<div class="hidden fixed inset-0 z-60 flex items-center justify-center p-4">
    <div class="modal-overlay fixed inset-0"></div>
    <div role="alertdialog" aria-labelledby="confirm-dialog-title" aria-describedby="confirm-dialog-desc" aria-modal="true" class="relative z-70 bg-surface-light dark:bg-surface-dark rounded-xl shadow-2xl border border-border-light dark:border-border-dark w-full max-w-md">

        <div class="px-6 py-5">
            <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-10 h-10 rounded-full bg-warning/10 flex items-center justify-center">
                    <span class="material-icons-outlined text-warning">warning</span>
                </div>
                <div class="flex-grow">
                    <h3 id="confirm-dialog-title" class="text-lg font-bold mb-2">작성 중인 내용이 있습니다</h3>
                    <p id="confirm-dialog-desc" class="text-sm text-slate-600 dark:text-slate-400">
                        작성 중인 내용이 저장되지 않았습니다. 닫으시겠습니까?
                    </p>
                </div>
            </div>
        </div>

        <div class="px-6 py-4 bg-slate-50 dark:bg-slate-800/50 flex flex-col sm:flex-row gap-3 rounded-b-xl">
            <button
                type="button"
                class="flex-1 px-4 py-2 border border-border-light dark:border-border-dark text-slate-600 dark:text-slate-300 font-medium rounded hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors text-sm"
            >
                취소
            </button>
            <button
                type="button"
                class="flex-1 px-4 py-2 bg-primary text-white font-medium rounded hover:bg-primary-dark transition-colors text-sm"
            >
                임시저장 후 닫기
            </button>
            <button
                type="button"
                class="flex-1 px-4 py-2 bg-danger text-white font-medium rounded hover:bg-danger/90 transition-colors text-sm"
            >
                그냥 닫기
            </button>
        </div>
    </div>
</div>

<script>
    // Character counter
    const bodyTextarea = document.getElementById('email-body');
    const charCount = document.getElementById('body-char-count');

    bodyTextarea.addEventListener('input', function() {
        const currentLength = this.value.length;
        charCount.textContent = `${currentLength} / 2000자`;
    });

    // Modal interaction examples (for demonstration)
    console.log('SC-08: Email Sending Modal - Design System Demo');
    console.log('Features:');
    console.log('- Template selection with variable substitution');
    console.log('- Real-time character counting');
    console.log('- Preview modal');
    console.log('- Confirmation dialog for unsaved changes');
    console.log('- Accessibility: ARIA labels, keyboard navigation');
</script>

</body>
</html>
